## 스프링을 사용하는 이유

스프링을 통해 할 수 있는 것들은 의존성을 주입하는 장치만 마련되어 있다면 스프링이 없어도 할 수 있다. 하지만 그럼에도 스프링을 사용하는 이유는, DI를 사용하는 방법과 best practice들이 쌓여있는 프레임워크이기 때문이다.



## IoC(Inversion of Control)

의존 주입(Dependency Injection)이라고도 한다. 어떤 객체가 사용하는 의존 객체를 직접 만들어서 사용하는 것이 아니라, 주입받아 사용하는 방법을 말한다. @Autowired를 사용해서 POJO 객체를 빈으로 등록하고 빈에 등록이 되어있는 객체를 주입받아서 사용할 수 있다.

스프링 초기엔 xml로 설정하는 것이 대세였지만 지금은 애노테이션 기반의 DI를 지원하기 시작했다.



## 스프링 IoC 컨테이너

IoC 컨테이너는 애플리케이션 컴포넌트의 중앙 저장소이다. 빈 설정 소스로부터 빈 정의를 읽어들이고, 빈을 구성하고 제공한다.

스프링 IoC의 컨테이너 최상위엔 BeanFactory라는 인터페이스가 있다. BeanFactory 인터페이스는 IoC 컨테이너의 가장 핵심이다. IoC 컨테이너 안에 들어있는 빈들은 다양한 라이프사이클을 통해 스프링이 기능을 제공하고 관리한다. 



## 빈

빈은 스프링 IoC 컨테이너가 관리하는 객체이다. 

일반적인 객체는 Getter, Setter가 있을 경우 자바 빈 스펙을 준수하기 때문에 자바 빈이라곤 할 수 있겠지만, 스프링 빈은 아니다.

### 

## IoC 컨테이너와 빈으로 관리하는 이유

#### 1. 의존성 주입때문이다.

의존성 주입을 받으려면 빈이여야 한다.

#### 2. 빈의 스코프 때문이다.

Service 인스턴스는 오직 하나만 있어도 된다. 굳이 여러개 만들어서 사용할 필요가 없다. 이렇게 싱글톤으로 관리하고 싶을 때도 IoC 컨테이너를 사용한다. 기본적으로 IoC 컨테이너에 등록되는 빈들은 싱글톤 스코프로 등록이 된다.

빈의 스코프는 두 가지가 있다.

- 싱글톤 : 객체 하나만 생성
- 프로토타입 : 매번 다른 객체 생성

따라서 IoC 컨테이너로부터 빈을 받아서 사용한다면 그 인스턴스들은 항상 같은 객체일 것이다. 메모리 면에서 성능이 최적화 되어있다. 특히 데이터베이스와 일을 하는 Repository 객체는 비용이 비쌀텐데 싱글톤으로 사용할 경우 효율적이다.

#### 3. 라이프사이클 인터페이스를 지원해준다.

예를 들어 빈이 만들어졌을때 추가적인 작업을 하고싶다면 @PostConstruct를 붙인 메소드를 만든다. 모든 빈이 만들어지면 라이프사이클 콜백에 해당하는 @PostConstruct의 메소드 호출이 된다.



## 의존성의 문제

의존성이 생기면 단위테스트를 만들기 힘들어진다. 게다가 의존성 주입을 할 수 없고 내부에서 객체를 직접 만들어서 사용할 경우 테스트하기 더욱 힘들어진다. 우리는 의존성 주입을 통해 가짜 객체를 만들어서 테스트할 수 있다.



## ApplicationContext

BeanFactory와 더불어서 실질적으로 우리가 가장 많이 사용할 인터페이스는 ApplicationContext이다. ApplicationContext도 BeanFactory를 상속받아서 BeanFactory가 갖고있는 IoC 컨테이너로서의 기능을 갖고있으면서도, 추가적으로 여러 인터페이스를 갖고있다.

예를 들어 MessageSource는 i18n이라고 하는 메시지 다국화용 기능을 갖고있다. 또한 ResourceLoader는 ClassPath에 있는 특정한 파일, 파일시스템에 있는 특정한 파일, 웹에 있는 파일과 같은 리소스들을 읽어오는 기능을 한다.