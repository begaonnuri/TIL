## 5.1 디스크 읽기 방식

전자식 장치인 CPU, 메모리와 달리 기계식 장치인 디스크의 성능은 제한적으로 발전했다. 데이터베이스의 성능 튜닝은 이러한 디스크 I/O를 줄이는 것이 관건이다.



### 5.1.1 저장 매체

저장 매체는 다음과 같다.

- 내장 디스크
- DAS(Direct Attached Storage)
- NAS(Network Attached Storage)
- SAN(Storage Area Network)

내장디스크는 PC에 장착된 디스크같은 매체이다. 내부 공간의 제한때문에 장착할 수 있는 디스크도 적고 용량도 부족하다.

내장 디스크의 용량 문제를 해결하기 위해 주로 사용하는 것이 DAS인데, DAS는 컴퓨터 본체와 달리 디스크만 있어서 컴퓨터 본체와 연결해서만 사용할 수 있다. 하지만 DAS는 하나의 컴퓨터 본체에만 연결해서 사용할 수 있기 때문에 여러 컴퓨터가 공유하는 것은 불가능하다.

내장디스크와 DAS의 문제를 해결하기 위해 사용하는것이 NAS와 SAN이다. 여러 컴퓨터에서 동시에 연결해서 사용한다. NAS는 TCP/IP를 통해 연결해서 SATA 방식의 직접 연결보다 속도는 느리기 때문에 데이터베이스 서버용으론 거의 사용되지 않는다.

SAN은 대용량의 스토리지 공간을 제공하는 장치다. 컴퓨터 본체와 광케이블로 연결하기 때문에 상당히 빠르고 안정적이다. 하지만 구축 비용이 비싸서 일반적으로 중요한 데이터를 보관할 경우에만 사용한다.



### 5.1.2 디스크 드라이브와 솔리드 스테이트 드라이브

성능이 낮은 디스크 드라이브를 대체하기 위해 전자식 저장매체인 SSD(Solid State Drive)가 등장했다. SSD도 기존의 디스크 드라이브와 같은 인터페이스(SATA, SAS)를 지원하기 때문에 내장 디스크, DAS, SAN에 그대로 사용할 수 있다.

SSD는 디스크 드라이브에서 원판 대신 플래시 메모리를 사용해서 성능이 좋다. 순차 I/O에서는 디스크 드라이브와 큰 차이가 없지만 랜덤 I/O의 경우 디스크 드라이브보다 훨씬 빠르다. 따라서 웹 서비스와 같은 OLTP 환경의 경우 SSD를 사용하는 것이 좋다.



### 5.1.3 랜덤 I/O와 순차 I/O

n개의 페이지를 디스크에 기록하기 위해서 순차 I/O는 1번의 시스템 콜이면 되지만 랜덤 I/O는 n번의 시스템 콜이 필요하다. 디스크에 기록할 위치를 찾기 위해 디스크 헤드를 움직이는 작업이 랜덤 I/O는 더 많이 필요해서 성능이 느리다.

디스크의 성능은 디스크 헤드를 이동하지 않고 얼마나 많은 데이터를 한번에 기록하냐에 달려있기 때문에 랜덤 I/O 작업이 부하가 더 크다.

인덱스 레인지 스캔은 랜덤 I/O를 사용하고 풀 테이블 스캔은 순차 I/O를 사용하는데, 큰 테이블을 읽는 작업에서 인덱스 대신 풀 테이블 스캔을 사용하는 이유도 순차 I/O가 랜덤 I/O보다 더 빠르기 때문이다.