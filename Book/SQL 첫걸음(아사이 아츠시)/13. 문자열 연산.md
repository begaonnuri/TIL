## 문자열 결합

문자열을 결합하는 연산자에는 방언이 존재해 데이터베이스 제품마다 차이가 있다.

| 연산자/함수 | 연산        | 데이터베이스            |
| ----------- | ----------- | ----------------------- |
| +           | 문자열 결합 | SQL Server              |
| \|\|        | 문자열 결합 | Oracle, DB2, PostgreSQL |
| CONCAT      | 문자열 결합 | MySQL                   |



문자열 결합은 2개의 열 데이터를 모아서 1개의 열로 처리하고 싶은 경우 자주 사용한다.

```mysql
	SELECT CANCAT(quantity, unit) FROM sample35;
```

unit은 '개' 처럼 개수를 나타내는 문자열형이고, quantity는 '100' 처럼 수량을 나타내는 INTEGER형이다. 두 열을 결합할 경우 새로운 행이 결합되어 '100개' 처럼 생성된다.



## SUBSTRING

`SUBSTRING` 함수는 문자열의 일부분을 계산해서 반환해주는 함수이다. 블로그 시스템 같은 곳에선 데이터를 특정짓기 위해 날짜와 번호를 사용해 ID를 가공하는 경우가 많은데, 이런 경우 `SUBSTRING`을 통해 문자열을 추출해 낼 수 있다.

```mysql
SUBSTRING('20140125001', 1, 4) // '2014'가 반환
```



## TRIM

문자열의 앞뒤로 공백이 있을 경우 이를 제거해주는 함수이다. 문자열 중간에 있는 공백은 제거되지 않는다. CHAR 형의 문자열형에선 문자열의 길이가 고정되고 남은 공간은 공백으로 채워진다. 이런 공백을 제거하는데 `TRIM` 함수를 사용할 수 있다.

```mysql
	TRIM('ABC    ') // 'ABC'가 반환
```



## CHARACTER_LENGTH

`CHARACTER_LENGTH`는 문자열의 길이를 반환해주는 함수이다. VARCHAR 형의 문자열은 가변 길이라서 길이가 서로 다르다. 이런 경우 `CHARACTER_LENGTH` 함수를 사용해 문자열의 길이를 구할 수 있다. `CHAR_LENGTH`로 줄여서 사용할 수도 있다.

한편 `OCTET_LENGTH` 는 문자열의 길이를 **바이트 단위**로 계산해 돌려주는 함수이다. 

문자 하나의 데이터가 몇 바이트의 저장공간을 필요로 하는지는 인코드 방식에 따라 결정된다. 즉, **인코드 방식에 따라 문자열을 저장하는데 필요한 저장공간의 크기가 달라진다.** `VARCHAR`형의 최대 길이는 바이트 단위로 지정되고, 문자열 세트(Character Set)에 따라 문자 수로 지정될 수도 있다.

#### 문자열 세트(Character Set)

알파벳, 숫자, 기호의 경우 `ASCII` 문자라고 불리며 한글에 비해 저장용량이 절반밖에 되지 않는다.

한글의 경우 `EUC-KR`, `UTF-8`등의 인코드 방식을 주로 사용한다. 이러한 인코드 방식을 RDBMS에선 `Character Set`이라고 부른다.

| Character Set | 문자 수 | 바이트 수 |
| ------------- | ------- | --------- |
| EUC-KR        | 12      | 19        |
| UTF-8         | 12      | 26        |

`EUC-KR`에서 ASCII 문자는 1바이트, **한글은 2바이트**의 용량을 가진다. `UTF-8`에선 ASCII 문자는 1바이트, **한글은 3바이트**의 용량을 가진다. `CHARACTER_LENGTH`를 사용할 땐 문제가 되지 않지만 `OCTET_LENGTH`를 사용하는 경우 바이트 단위로 길이를 계산하기 때문에 문자열 세트를 주의해야 한다.

