## 데이터베이스 설계

데이터베이스를 설계하는 것은 데이터베이스의 스키마 내에 데이터베이스 객체를 정의하는 것이다. 스키마 내에 정의한다는 뜻으로 '스키마 정의' 라고도 한다.

데이터베이스 설계의 주된 내용은 테이블의 이름이나 열, 자료형을 결정하는 것이다. 테이블을 설계할 땐 테이블 정의서나 설계도 등의 문서를 작성하는데, 일반적으로 `DESC` 명령에 표시되는 결과와 같은 양식을 사용한다.

| 열명     | 자료형      | NULL | 기본값 | 비고 |
| -------- | ----------- | ---- | ------ | ---- |
| 상품코드 | CHAR(4)     | No   |        |      |
| 상품명   | VARCHAR(30) | Yes  |        |      |



#### 논리명과 물리명

테이블을 설계할 때는 두개의 테이블 이름을 지정하기도 한다. 하나는 `CREATE TABLE` 명령에 사용되는 물리명이고, 다른 하나는 테이블을 설계할 때 사용하는 논리명이다.

물리명은 DBMS의 규칙에 따라 길이제한 등의 제약이 있다. 제약으로 인해 물리명만으로는 의미가 전달되지 않는 경우가 생기기 때문에 논리명이 필요하다. 논리명은 실제 테이블을 부를때 사용하는 이름으로 언제나 변경할 수 있다.

문서에선 논리명을 별도의 열에 기입하거나 비고에 기재한다.



#### 자료형

데이터에 따라 '1, 2, 3 중 하나' 혹은 'yes, no 중 하나'만 값으로 취급하는 경우가 있다. 이 경우 `CHECK` 제약을 사용해 정합성을 확인한다. 데이터베이스 시스템에서 데이터 정합성을 체크할 수 있다면 데이터베이스 시스템에 맡기는 것이 확실하고 편리하다. '1, 2, 3' 과 같은 경우 데이터의 의미를 알기 힘들기 때문에 비고를 적어준다.



#### 고정길이와 가변길이

데이터베이스 열에 저장할 수 있는 크기는 많지 않다. 큰 파일을 저장할 경우 VARCHAR형이 아닌 LOB형을 사용한다. **LOB은 Large Object의 약자로 큰 데이터를 다룰 수 있다**. 하지만 인덱스를 지정할 수 없다.



#### 기본키

테이블의 행에 유일성을 지정한다는 것은 중요한 일이다. 기본키로 지정할 열을 생각하기 어려운 경우 자동증가를 사용한다. `INSERT`할 경우 번호를 자동으로 증가해서 저장해준다. 자동증가는 `AUTO_INCREMENT`로 지정할 수 있는데, 자동증가로 지정한 열은 `PRIMARY KEY` 또는 `UNIQUE`로 유일성을 지정해야 한다.



## ER다이어그램

테이블을 설계할 때 테이블 간의 관계를 명확히 하기 위해 ER다이어그램을 사용한다. **ER다이어그램의 ER은 Entity Relationship의 약자로 개체 간의 관계를 표현**한다.

Entity는 개체로 테이블 또는 뷰를 의미한다. 개체는 사각형으로 표기하고 상단엔 개체 이름, 사각형 안에는 개체 속성을 표기한다. 기본키가 되는 열부터 차례로 기술하며 주로 논리명으로 표기한다.

개체와 개체가 연계되는 경우 선으로 이어서 표기한다. 연계를 표기할 때는 몇 대 몇의 관계를 갖는지 숫자나 기호로 나타낼 수 있다. 이를 **카디널리티** 또는 다중도라고 한다.

- 일대일(1:1)
- 일대다(1:n)
- 다대다(n:n)

**ER다이어그램의 연계는 외부키 제약으로 지정**되는 경우가 많다.